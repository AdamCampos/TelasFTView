<?xml version="1.0" encoding="UTF-8"?>
<gfx xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="Gfx-SE10.xsd">
    <displaySettings displayType="replace" position="specifyPositionInPixels" positionX="0" positionY="150" securityCode="*" backColor="silver" titleBar="false" maximumTagUpdateRate="1" focusHighlightColor="silver" disableFocusHighlight="true" size="specifySizeInPixels" width="1920" height="880" allowMultipleRunningCopies="false" cacheAfterDisplaying="false" sizeToMainWindow="false" showLastAcquiredValue="true" TrackScreenForNavigation="false" allowResizing="false" whenResized="pan" beepOnPress="false" highlightWhenCursorPassesOver="true" interactiveHighlightColor="black" displayOnScreenKeyboard="false" allowButtonActionOnError="true" fieldNotSelectedTextColor="black" fieldNotSelectedFillColor="white" fieldSelectedTextColor="black" fieldSelectedFillColor="white" fieldInErrorNotSelectedTextColor="black" fieldInErrorNotSelectedFillColor="red" fieldInErrorSelectedTextColor="white" fieldInErrorSelectedFillColor="red" startupCommand="Display tela_ger_rodape /Prodape_tela_ger_grafico_tendencia;Display tela_ger_cabecalho_botoes /Ttela_ger_inicial;Invoke Me.BotaoMCE.Visible (False);Invoke Me.BotaoPartida.Visible (False)" shutdownCommand="" useGradientStyle="false" endColor="teal" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight"/>
    <panel name="ToolBar" height="52" width="1916" left="2" top="2" visible="true" wallpaper="false" toolTipText="" exposeToVba="typeInfoExtension" isReferenceObject="false" backStyle="solid" patternStyle="none" backColor="silver" patternColor="white" blink="false" description="" borderColor="silver" borderStyle="raised" borderWidth="1" borderUsesBackColor="false" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight"/>
    <text name="ScreenName" height="14" width="83" left="1826" top="844" visible="false" wallpaper="false" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" backStyle="transparent" backColor="white" foreColor="black" wordWrap="true" sizeToFit="true" alignment="middleCenter" fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="Trend Dynamic"/>
    <group name="Group1" visible="true" wallpaper="false" toolTipText="" exposeToVba="notExposed" isReferenceObject="false">
        <button name="btn30Sec" height="46" width="80" left="330" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="6">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="30 seg."/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn1Min" height="46" width="80" left="428" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="7">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="1 min."/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn2Min" height="46" width="80" left="526" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="8">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="2 min."/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn10Min" height="46" width="80" left="624" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="9">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="10 min."/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn30Min" height="46" width="80" left="722" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="10">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="30 min."/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn1h" height="46" width="80" left="820" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="11">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="1 hora"/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn2h" height="46" width="80" left="1016" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="12">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="2 horas"/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn6h" height="46" width="80" left="1114" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="13">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="6 horas"/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn12h" height="46" width="80" left="1212" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="14">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="12 horas"/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn1j" height="46" width="80" left="1310" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="15">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="1 dia"/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn2j" height="46" width="80" left="1408" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="16">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="2 dia"/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn1s" height="46" width="80" left="1506" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="17">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="1 semana"/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btnPause" height="46" width="80" left="918" top="828" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="18">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="8" bold="true" italic="false" underline="false" strikethrough="false" caption="Pausa"/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Courier New" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
    </group>
    <activeX name="TrendX" height="750" width="1912" left="1" top="64" visible="true" wallpaper="false" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" classId="{D0569F8A-3B30-46B4-B889-EAFEFD50DD6C}" keyNavigation="true" focusHighlight="false" pointerHighlight="false" tabIndex="19">
        <data progId="RSTX.Trend.1" fileName="RSTXView2.ocx" fileVersion="9.0.241.0" typeLibrary="{7B774452-2FB4-4B76-B11C-205D28E74BEB}" typeLibVersion="4.0" data="AAAEAJzFAACETQAAAAAAAAwAAAD//v8AAQAAAAAAAAD/////yAAAAP/9AwAAA1LjC5GPzhGd&#xA;4wCqAEu4UQEAAACQAURCAQAFQXJpYWwAAAAAAAAAAAEAAAAAAAAA//7/AP/+/wABYOoAAAAA&#xA;AAD///8AAAAAAAIAAAAAqgIAAAAADQAAAAEAAAD/////AQAAAAEAAAABAAAAAQAAAAEAAAAB&#xA;AAAAAQAAAAAAAAABAAAAAQAAAAEAAAABAAAAAQAAAAAAwMDAAAEAAAAEAAAAAwAAAAAAAAAA&#xA;AAAAAADIQgAAAAAAAAAABAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////wAAAAAsAAAAWHfy&#xA;DogqbQpYLIkXgItjCtDDaQpcd/IOVyyJF9CLYwoIBPAOzHfyDoCAgACAgIAA/+//////ff8K&#xA;AACAZFAuWgAAAAABAAAAWwMAAAoAAICkiC5aAAAAAAEAAABbAwAA//7/AAEAAAABAAAAAAAC&#xA;AAAANwAAAOgDAAAAAAAAAAAAAFwAAAD1////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#xA;AAAAAAD//v8FQQByAGkAYQBsAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#xA;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAAA//7/AP/+/wD/&#xA;/v8A//7/ACABAAAA//7/AP/+/wADAAAAAAAAAP/+/wD//v8A//7/AP/+/wAgAQAAAP/+/wD/&#xA;/v8AAAAAAAAAAAD///8AAQAAAAUAAAABAAAAAQAAABAAAAAAAAAAAAAAAAAAAAAAAAAABAD/&#xA;/v8MUABJAFQALQA1ADEANAA3ADAAMAA3AEQA//7/DFAASQBUAC0ANQAxADQANwAwADAANwBE&#xA;AP/+/wxQAEkAVAAtADUAMQA0ADcAMAAwADcARAD//v8MUABJAFQALQA1ADEANAA3ADAAMAA3&#xA;AEQA//7/AAMAAAAAAAAAAAAAAAAAAAD///8AMgAAAAAAAAAAAAAAAAABAAAAxQAAABQA&#xA;DQA="/>
    </activeX>
    <text name="lblFileName" height="16" width="219" left="1693" top="861" visible="true" wallpaper="false" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" backStyle="transparent" backColor="black" foreColor="black" wordWrap="true" sizeToFit="false" alignment="middleRight" fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="File Name"/>
    <text name="LabelTitle" height="35" width="783" left="569" top="11" visible="true" wallpaper="false" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" backStyle="transparent" backColor="black" foreColor="black" wordWrap="false" sizeToFit="false" alignment="middleCenter" fontFamily="Arial" fontSize="14" bold="true" italic="false" underline="false" strikethrough="false" caption="TREND"/>
    <group name="Group2" visible="true" wallpaper="false" toolTipText="" exposeToVba="notExposed" isReferenceObject="false">
        <button name="btn_load" height="48" width="49" left="4" top="4" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="0" captureCursor="false" highlightOnFocus="false" tabIndex="1">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="useImageReference" imageName="ouvrir" scaled="false"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="#D4D0C8" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn_save" height="48" width="49" left="54" top="4" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="0" captureCursor="false" highlightOnFocus="false" tabIndex="2">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="useImageReference" imageName="disquette2" scaled="false"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="#D4D0C8" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn_delete" height="48" width="48" left="104" top="4" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="0" captureCursor="false" highlightOnFocus="false" tabIndex="3">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="useImageReference" imageName="suppr" scaled="false"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="#D4D0C8" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn_clear" height="48" width="49" left="1868" top="4" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="0" captureCursor="false" highlightOnFocus="false" tabIndex="4">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="useImageReference" imageName="pens" scaled="false"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="#D4D0C8" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="btn_timespan" height="48" width="49" left="1818" top="4" visible="true" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" style="beveled" bevelWidth="0" captureCursor="false" highlightOnFocus="false" tabIndex="5">
            <command pressAction="" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="useImageReference" imageName="ZoomFit" scaled="false"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="#D4D0C8" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="Button1" height="48" width="48" left="153" top="4" visible="true" toolTipText="Imprimir" exposeToVba="notExposed" isReferenceObject="false" style="beveled" bevelWidth="1" captureCursor="false" highlightOnFocus="false" tabIndex="20">
            <command pressAction="PrintDisplay me" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="silver" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="13" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="useImageReference" imageName="icon_printer" scaled="false"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="#D4D0C8" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="13" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
        </button>
        <button name="Button16" height="48" width="1915" left="4" top="4" visible="true" toolTipText="" exposeToVba="notExposed" isReferenceObject="false" style="noborder" captureCursor="false" highlightOnFocus="false" tabIndex="21">
            <command pressAction="1" repeatAction="" releaseAction="" repeatRate="0.25"/>
            <up patternColor="black" patternStyle="none" backColor="#D4D0C8" backStyle="transparent" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </up>
            <down downSameAsUp="true" patternColor="black" patternStyle="none" backColor="#D4D0C8" backStyle="solid" foreColor="black" endColor="white" gradientStop="50" gradientDirection="gradientDirectionHorizontal" gradientShadingStyle="gradientHorizontalFromRight">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption=""/>
                <imageSettings imageReference="noImage"/>
            </down>
            <ability showDisabledState="false" expression="" enabledWhenExpressionIsTrue="true" disabledImageType="useGrayscale"/>
            <confirm confirmAction="false" buttonSetting="okCancel" titleBar="true" titleBarText="Confirmation" windowPosition="Centered of screen">
                <caption fontFamily="Arial" fontSize="10" bold="false" italic="false" underline="false" strikethrough="false" caption="Are you sure you want to perform this action?"/>
                <imageSettings imageReference="noImage"/>
            </confirm>
            <animations>
                <animateVisibility expression="if CurrentUserHasCode( O )==1 then 1 else 0" expressionTrueState="invisible"/>
            </animations>
        </button>
    </group>
    <text name="Pause" height="17" width="49" left="1754" top="847" visible="false" wallpaper="false" toolTipText="" exposeToVba="vbaControl" isReferenceObject="false" backStyle="transparent" backColor="white" foreColor="black" wordWrap="true" sizeToFit="true" alignment="middleCenter" fontFamily="Arial" fontSize="11" bold="false" italic="false" underline="false" strikethrough="false" caption="PAUSA"/>
    <vbaProject>
        <vbaItem>
            <!--Item Name:ThisDisplay, Item Type:HostProjectItem-->
            <encryptedData hash="8d11e2ea90dfed5a96a34bbe51e8b9ff">
                <!--The following VBA code is encoded.Please do not edit or import will fail.-->
                <![CDATA[J05BTUU9VGhpc0Rpc3BsYXksVFlQRT0zDQpWRVJTSU9OIDEuMCBDTEFTUw0KQkVHSU4NCiAgTXVs
dGlVc2UgPSAtMSAgJ1RydWUNCkVORA0KQXR0cmlidXRlIFZCX05hbWUgPSAiVGhpc0Rpc3BsYXki
DQpBdHRyaWJ1dGUgVkJfR2xvYmFsTmFtZVNwYWNlID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9DcmVh
dGFibGUgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX1ByZWRlY2xhcmVkSWQgPSBUcnVlDQpBdHRyaWJ1
dGUgVkJfRXhwb3NlZCA9IFRydWUNCg==]]>
            </encryptedData>
            <vbaCode>
                <![CDATA[Option Explicit

'==========================================================================
' CONSTANTES GLOBALES
'==========================================================================
Const BUTTON_SIZE As Integer = 48
Const GROUP_SIZE As Integer = 4
Const TITLE_SIZE As Integer = 700

'==========================================================================
' TYPES SPECIFIQUES
'==========================================================================
Private Type TrendChart
    ChartTitle As String
    BackColor As Long
    Scroll As String
    XTimeSpan As Long
    XStartTime As Date
    YMinMaxOption As Long
    YCustomMinOption As Long
    YCustomMin As Long
    YCustomMaxOption As Long
    YCustomMax As Long
End Type

Private Type TrendPen
    Name As String
    Description As String
    Unite As String
    Min As Long
    Max As Long
    DataModel As String
    Historian As Boolean
    Color As OLE_COLOR
    Marker As Long
    Style As Long
    Width As Long
End Type


'==========================================================================
' EVENEMENTS SUR LA FENETRE
'==========================================================================

'------------------------------------------------------------------
' Display_AnimationStart
'------------------------------------------------------------------
' Cet évènement initialise les fonctionnalités de la vue.
' Paramètres attendus :
' - Aucun pour le moment
'------------------------------------------------------------------
Private Sub Display_AnimationStart()
    Dim Parametre_Date As Date
    Dim Parametre_Duree As Long
    
    On Error GoTo ErrHandler
    
    TrendPath = "\\" & GetHMIServerName & "\" & PATH_DIRECTORY
    'Initialisation du TrendX par défaut
      InitTrendX
      
    'On vérifie si on a demandé une courbe à charger
    If TagParameters.Count >= 1 Then
            
        lblFileName.Caption = TagParameters(1)
        LoadTrend
        
        If TagParameters.Count >= 2 Then
            Parametre_Date = CDate(TagParameters(2))
            frm_timespan.opt_nostartdate.Value = False
            frm_timespan.cb_annee_start = Year(Parametre_Date)
            frm_timespan.cb_mois_start.ListIndex = Month(Parametre_Date) - 1
            frm_timespan.cb_jour_start = Day(Parametre_Date)
            frm_timespan.tb_heure_start.Text = Hour(Parametre_Date)
            frm_timespan.tb_minute_start.Text = Minute(Parametre_Date)
            frm_timespan.tb_seconde_start.Text = Second(Parametre_Date)
            
            If TagParameters.Count >= 3 Then
            
                If IsNumeric(TagParameters(3)) Then
                    'TimeSpan en secondes
                    Parametre_Duree = CLng(TagParameters(3))
                    frm_timespan.cb_timespan_type.ListIndex = 0
                    frm_timespan.tb_timespan_value.Text = Parametre_Duree
                    
                Else
                    'Timespan basé sur la date de fin
                    frm_timespan.opt_noenddate.Value = False
                    Parametre_Date = CDate(TagParameters(3))
                    frm_timespan.cb_annee_end = Year(Parametre_Date)
                    frm_timespan.cb_mois_end.ListIndex = Month(Parametre_Date) - 1
                    frm_timespan.cb_jour_end = Day(Parametre_Date)
                    frm_timespan.tb_heure_end.Text = Hour(Parametre_Date)
                    frm_timespan.tb_minute_end.Text = Minute(Parametre_Date)
                    frm_timespan.tb_seconde_end.Text = Second(Parametre_Date)
                End If
                
            End If
            
            ModifyTrend
            
        End If
        
    End If
    
    
    ScreenName.Caption = ThisDisplay.Name
    ScreenName.Visible = False
Exit Sub
ErrHandler:
End Sub

'------------------------------------------------------------------
' btn_load_Released
'------------------------------------------------------------------
' Cet évènement affiche la liste des fichiers courbes existants
' afin que l'utilisateur puisse charger une courbe.
'------------------------------------------------------------------
Private Sub btn_load_Released()

On Error GoTo ErrHandler

    frm_file.ButtonOK.Caption = "Open"
    frm_file.TrendName.Text = TrendSubPath
    frm_file.Security = Security_Load
    frm_file.Show 1
    If frm_file.TrendName.Text <> "" Then
        lblFileName.Caption = TrendSubPath & frm_file.TrendName.Text
        LoadTrend
    End If

Exit Sub
ErrHandler:
End Sub

'------------------------------------------------------------------
' btn_save_Released
'------------------------------------------------------------------
' Cet évènement affiche une fenêtre afin que l'utilisateur puisse
' sauver une courbe.
'------------------------------------------------------------------
Private Sub btn_save_Released()

On Error GoTo ErrHandler

    If TrendX.Pens.Count < 1 Then
        MsgBox "There is no pens in your Trend!", vbInformation, "Save trend"
        Exit Sub
    End If
    frm_file.ButtonOK.Caption = "Save"
    frm_file.TrendName.Text = lblFileName.Caption
    frm_file.Security = Security_Save
    frm_file.Show 1
    If frm_file.TrendName.Text <> "" Then
        lblFileName.Caption = TrendSubPath & frm_file.TrendName.Text
        SaveTrend
    End If
Exit Sub
ErrHandler:
End Sub

'------------------------------------------------------------------
' btn_delete_Released
'------------------------------------------------------------------
' Cet évènement affiche la liste des fichiers courbes existants
' afin que l'utilisateur puisse supprimer une courbe.
'------------------------------------------------------------------
Private Sub btn_delete_Released()

On Error GoTo ErrHandler

    frm_file.ButtonOK.Caption = "Delete"
    frm_file.TrendName.Text = TrendSubPath
    frm_file.Security = Security_Delete
    frm_file.Show 1
    If frm_file.TrendName.Text <> "" Then
        lblFileName.Caption = TrendSubPath & frm_file.TrendName.Text
        DeleteTrend
    End If
Exit Sub
ErrHandler:
End Sub

'------------------------------------------------------------------
' btn_clear_Released
'------------------------------------------------------------------
' Cet évènement supprime les pens de la courbe.
'------------------------------------------------------------------
Private Sub btn_clear_Released()
On Error GoTo ErrHandler

    ClearTrend
Exit Sub
ErrHandler:
End Sub

'------------------------------------------------------------------
' btn_timespan_Released
'------------------------------------------------------------------
' Ce bouton permet de choisr une plage de temps à afficher.
'------------------------------------------------------------------
Private Sub btn_timespan_Released()
On Error GoTo ErrHandler

    frm_timespan.tb_timespan_value.Text = TrendX.XAxis.TimeSpan
    frm_timespan.StartTime.Text = TrendX.XAxis.StartTime
    frm_timespan.Show 1
    ModifyTrend
Exit Sub
ErrHandler:
End Sub



'==========================================================================
' FONCTIONS PRIVEES
'==========================================================================

Private Sub InitTrendX()
    'On vire tous les pens existants dans le graphique
    
    On Error GoTo ErrHandler
    
    
    Do While TrendX.Pens.Count > 0
        TrendX.Pens.Remove 1
        VBA.DoEvents
    Loop

    'On vire tous les overlays existants dans le graphique
    Do While TrendX.Overlays.Count > 0
        TrendX.Overlays.Remove 1
        VBA.DoEvents
    Loop
    
Exit Sub
ErrHandler:
End Sub

Private Sub LoadTrend()
    Dim Trend As TrendChart
    Dim Pen As TrendPen
    Dim FilePath As String
    Dim FileName As String
    Dim Result As String
    Dim P As Pen

    On Error GoTo ErrHandler
    ClearTrend

    FilePath = "\\" & GetHMIServerName & "\" & PATH_DIRECTORY
    If Not VerifyPath(FilePath) Then
        MsgBox "The selected folder doens't exist, please select a valid folder.", vbExclamation, "Open Trend"
        Exit Sub
    End If

    FileName = FilePath & lblFileName.Caption & EXTENSION
    If Dir(FileName) = "" Then
        MsgBox "Trend " & lblFileName.Caption & " doesn't exist !", vbCritical, "Open Trend"
        Exit Sub
    End If

    'Ouverture du fichier source
    Open (FileName) For Input As #1

'TODO: Il faut charger plus d'informations sur la courbe en général
    'Chargement des informations de la courbe
    Input #1, Trend.ChartTitle _
            , Trend.BackColor _
            , Trend.Scroll _
            , Trend.XStartTime _
            , Trend.XTimeSpan _
            , Trend.YMinMaxOption _
            , Trend.YCustomMinOption _
            , Trend.YCustomMin _
            , Trend.YCustomMaxOption _
            , Trend.YCustomMax

    'On lit tous les pens de la courbe
    Do While Not EOF(1)
        Input #1, Pen.Name _
                , Pen.Description _
                , Pen.Unite _
                , Pen.Min _
                , Pen.Max _
                , Pen.DataModel _
                , Pen.Color _
                , Pen.Marker _
                , Pen.Style _
                , Pen.Width
                
        'If Pen.DataModel = "TSHISTSVRAB" Then
            Pen.Historian = True
        'Else
        '    Pen.Historian = False
        'End If
        
        Set P = TrendX.Pens.Add(Pen.Name _
                        , Pen.Description _
                        , Pen.Unite _
                        , Pen.Min _
                        , Pen.Max _
                        , Pen.DataModel _
                        , Pen.Historian _
                        , True _
                        )
        P.Color = Pen.Color
        P.Marker = Pen.Marker
        P.Style = Pen.Style
        P.Width = Pen.Width
        
    VBA.DoEvents
    Loop
    'On referme le fichier
    Close #1

    'On applique les options du graphique
    ApplyTrend Trend
    LabelTitle.Caption = Trend.ChartTitle
    ' MsgBox "FilePath: " & FilePath

Exit Sub
ErrHandler:
    'On referme le fichier proprement
    Close #1
End Sub

Private Sub SaveTrend()
    Dim FilePath As String
    Dim FilePath_Primary As String
    Dim FilePath_Secondary As String
    Dim FileName As String
    Dim FileName_Primary As String
    Dim FileName_Secondary As String
    
    On Error GoTo ErrHandler

    FilePath = "\\" & GetHMIServerName & "\" & PATH_DIRECTORY
    FilePath_Primary = "\\" & PRIMARY_SERVER & "\" & PATH_DIRECTORY
    FilePath_Secondary = "\\" & SECONDARY_SERVER & "\" & PATH_DIRECTORY
    If Not VerifyPath(FilePath) Then
        MsgBox "The select file doens't exist, please select a valid folder.", vbExclamation, "Save Trend"
        Exit Sub
    End If

    FileName = FilePath & lblFileName.Caption & EXTENSION
    FileName_Primary = FilePath_Primary & lblFileName.Caption & EXTENSION
    FileName_Secondary = FilePath_Secondary & lblFileName.Caption & EXTENSION

    If Dir(FileName) <> "" Then
        If MsgBox("This file already exist, would you like to overwrite it?", vbOKCancel, "Save Trend") = vbCancel Then
            Exit Sub
        End If
    End If

    'Ouverture du fichier destination
    Open (FileName) For Output As #1
    'On sauve dedans
    Ecriture_Fichier
    'On referme le fichier
    Close #1

    'On sauvegarde sur l'autre serveur HMI s'il y en a un
    If SECONDARY_SERVER <> "" Then
        If LCase(FileName) = LCase(FileName_Primary) Then
            If Not VerifyPath(FilePath_Secondary) Then
                MsgBox "The select folder doens't exist, please select a valid folder.", vbExclamation, "Save Trend"
            Else
                'Ouverture du fichier destination
                Open (FileName_Secondary) For Output As #1
                'On sauve dedans
                Ecriture_Fichier
                'On referme le fichier
                Close #1
            End If
        Else
            If Not VerifyPath(FilePath_Primary) Then
                MsgBox "The selected folder at primary server doesn't exist, please select a valid folder.", vbExclamation, "Save Trend"
            Else
                'Ouverture du fichier destination
                Open (FileName_Primary) For Output As #1
                'On sauve dedans
                Ecriture_Fichier
                'On referme le fichier
                Close #1
            End If
        End If
    End If
    'On reprend le titre utilisé pour la sauvegarde
    LabelTitle.Caption = lblFileName.Caption
    'On signale la sauvegarde à l'utilisateur
    MsgBox "Trend Saved !", vbInformation, "Save Trend"
Exit Sub
ErrHandler:
End Sub

Private Sub ApplyTrend(Trend As TrendChart)
    Dim Days, Hours, Minutes, Seconds As Long

    On Error GoTo ErrHandler

    Days = CInt(Trend.XTimeSpan / 86400)
    Hours = CInt((Trend.XTimeSpan - (Days * 86400)) / 3600)
    Minutes = CInt((Trend.XTimeSpan - (Days * 86400) - (Hours * 3600)) / 60)
    Seconds = Trend.XTimeSpan - (Days * 86400) - (Hours * 3600) - (Minutes * 60)

    TrendX.ChartTitle = Trend.ChartTitle
    TrendX.BackgroundColor = Trend.BackColor
    TrendX.XAxis.SetStartTimeAndSpan Trend.XStartTime, 0, Days, Hours, Minutes, Seconds, 0
    TrendX.YAxis.MinMaxOption = Trend.YMinMaxOption
    TrendX.YAxis.CustomMaxOption = Trend.YCustomMaxOption
    TrendX.YAxis.CustomMax = Trend.YCustomMax
    TrendX.YAxis.CustomMinOption = Trend.YCustomMinOption
    TrendX.YAxis.CustomMin = Trend.YCustomMin
    TrendX.Scroll = False
    If Trend.Scroll = "#TRUE#" Then
        TrendX.Scroll = True
    End If

Exit Sub
ErrHandler:
End Sub

Private Sub ModifyTrend()
    On Error GoTo ErrHandler

    'On applique les changements au graphique suivant les choix faits
    If frm_timespan.opt_nostartdate.Value Then
        Select Case (frm_timespan.cb_timespan_type.ListIndex)
            Case 0
                TrendX.XAxis.TimeSpan = frm_timespan.tb_timespan_value.Text
            Case 1
                TrendX.XAxis.TimeSpan = 60 * frm_timespan.tb_timespan_value.Text
            Case 2
                TrendX.XAxis.TimeSpan = 3600 * frm_timespan.tb_timespan_value.Text
            Case 3
                TrendX.XAxis.TimeSpan = 86400 * frm_timespan.tb_timespan_value.Text
            Case Else
                TrendX.XAxis.TimeSpan = 172800
        End Select
        TrendX.Scroll = False
        TrendX.Scroll = True
    Else
        TrendX.Scroll = False
        TrendX.XAxis.StartTime = CDate(frm_timespan.cb_annee_start & "-" & frm_timespan.cb_mois_start.ListIndex + 1 & "-" & frm_timespan.cb_jour_start & " " & frm_timespan.tb_heure_start.Text & ":" & frm_timespan.tb_minute_start.Text & ":" & frm_timespan.tb_seconde_start.Text)
        If frm_timespan.opt_noenddate.Value Then
            Select Case (frm_timespan.cb_timespan_type.ListIndex)
                Case 0
                    TrendX.XAxis.TimeSpan = frm_timespan.tb_timespan_value.Text
                Case 1
                    TrendX.XAxis.TimeSpan = 60 * frm_timespan.tb_timespan_value.Text
                Case 2
                    TrendX.XAxis.TimeSpan = 3600 * frm_timespan.tb_timespan_value.Text
                Case 3
                    TrendX.XAxis.TimeSpan = 86400 * frm_timespan.tb_timespan_value.Text
                Case Else
                    TrendX.XAxis.TimeSpan = 172800
            End Select
        Else
            TrendX.XAxis.TimeSpan = DateDiff("s", TrendX.XAxis.StartTime, CDate(frm_timespan.cb_annee_end & "-" & frm_timespan.cb_mois_end.ListIndex + 1 & "-" & frm_timespan.cb_jour_end & " " & frm_timespan.tb_heure_end.Text & ":" & frm_timespan.tb_minute_end.Text & ":" & frm_timespan.tb_seconde_end.Text))
        End If
    End If
    Exit Sub

Exit Sub
ErrHandler:
End Sub

Private Sub DeleteTrend()
    Dim FilePath As String
    Dim FilePath_Primary As String
    Dim FilePath_Secondary As String
    Dim FileName As String
    Dim FileName_Primary As String
    Dim FileName_Secondary As String

On Error GoTo ErrHandler

    FilePath = "\\" & GetHMIServerName & "\" & PATH_DIRECTORY
    FilePath_Primary = "\\" & PRIMARY_SERVER & "\" & PATH_DIRECTORY
    FilePath_Secondary = "\\" & SECONDARY_SERVER & "\" & PATH_DIRECTORY
    If Not VerifyPath(FilePath) Then
        MsgBox "The select folder doens't exist, please select a valid folder.", vbExclamation, "Save Trend"
        Exit Sub
    End If
    If Not VerifyPath(FilePath_Primary) Then
        MsgBox "The selected folder at primary server doesn't exist, please select a valid folder.", vbExclamation, "Save Trend"
        Exit Sub
    End If
    If SECONDARY_SERVER <> "" Then
        If Not VerifyPath(FilePath_Secondary) Then
            MsgBox "The selected folder at secondary server doesn't exist, please select a valid folder.", vbExclamation, "Save Trend"
            Exit Sub
        End If
    End If

    FileName = FilePath & lblFileName.Caption & EXTENSION
    FileName_Primary = FilePath_Primary & lblFileName.Caption & EXTENSION
    FileName_Secondary = FilePath_Secondary & lblFileName.Caption & EXTENSION
    If Dir(FileName) <> "" Then
        If MsgBox("Would you like to delete Trend " & lblFileName.Caption & " ?", vbOKCancel, "Delete Trend") = vbOK Then
            Kill FileName_Primary
            If SECONDARY_SERVER <> "" Then
                Kill FileName_Secondary
            End If
            'On signale la suppression à l'utilisateur
            MsgBox "trend Deleted !", vbInformation, "Delete Trend"
        End If
    End If
Exit Sub
ErrHandler:
End Sub

Private Sub ClearTrend()
On Error GoTo ErrHandler
    'On supprime tous les pens actuels
    Do While TrendX.Pens.Count > 0
        TrendX.Pens.Remove 1
        
        VBA.DoEvents
    Loop
Exit Sub
ErrHandler:
End Sub

Private Sub Ecriture_Fichier()
    Dim Pen As Long
    Dim DataLogModel As String
On Error GoTo ErrHandler

'TODO: Il faut sauver plus d'informations sur la courbe en général
    'Sauvegarde des informations de la courbe
    Write #1, lblFileName.Caption _
            , TrendX.BackgroundColor _
            , TrendX.Scroll _
            , TrendX.XAxis.StartTime _
            , TrendX.XAxis.TimeSpan _
            , TrendX.YAxis.MinMaxOption _
            , TrendX.YAxis.CustomMinOption _
            , TrendX.YAxis.CustomMin _
            , TrendX.YAxis.CustomMaxOption _
            , TrendX.YAxis.CustomMax

'TODO: Il faut sauver plus d'informations sur les pens (couleur et cie)
    'On écrit tous les pens de la courbe
    For Pen = 1 To TrendX.Pens.Count
        If TrendX.Pens(Pen).DatalogModelName = "" Then
            DataLogModel = "LIVEDATA"
        Else
            DataLogModel = Replace(TrendX.Pens(Pen).DatalogModelName, vbLf, "")
        End If
        Write #1, TrendX.Pens(Pen).Name _
                , TrendX.Pens(Pen).Description _
                , TrendX.Pens(Pen).EngineeringUnits _
                , TrendX.Pens(Pen).Min _
                , TrendX.Pens(Pen).Max _
                , DataLogModel _
                , TrendX.Pens(Pen).Color _
                , TrendX.Pens(Pen).Marker _
                , TrendX.Pens(Pen).Style _
                , TrendX.Pens(Pen).Width
                
    VBA.DoEvents
    Next Pen
Exit Sub
ErrHandler:
End Sub

Private Function VerifyPath(Path As String) As Boolean
    VerifyPath = True
    On Error GoTo NoPath
    GetAttr (Path)
    Exit Function
NoPath:
    VerifyPath = False
End Function

Private Function GetHMIServerName() As String
    If Me.AreaName = "/" Then
        GetHMIServerName = PRIMARY_SERVER
    Else
        GetHMIServerName = Application.GetHMIServerComputerName(Me.AreaName)
    End If
End Function

Private Sub btnPause_Released()
On Error GoTo ErrHandler

    If TrendX.Scroll = True Then
        TrendX.Scroll = False
        btnPause.ForeColor = vbBlue
        Pause.Visible = True
    Else
        TrendX.Scroll = True
        btnPause.ForeColor = RGB(0, 0, 0)
        Pause.Visible = False
    End If
Exit Sub
ErrHandler:
End Sub

Private Sub btn1s_Released()
    TrendX.XAxis.TimeSpan = 1209600
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = vbGreen
End Sub

Private Sub btn2j_Released()
    TrendX.XAxis.TimeSpan = 172800
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = vbGreen
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn1j_Released()
    TrendX.XAxis.TimeSpan = 86400
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = vbGreen
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn12h_Released()
    TrendX.XAxis.TimeSpan = 43200
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = vbGreen
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn6h_Released()
    TrendX.XAxis.TimeSpan = 21600
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = vbGreen
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn2h_Released()
    TrendX.XAxis.TimeSpan = 7200
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = vbGreen
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn1h_Released()
    TrendX.XAxis.TimeSpan = 3600
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = vbGreen
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn30Min_Released()
    TrendX.XAxis.TimeSpan = 1800
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = vbGreen
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn10Min_Released()
    TrendX.XAxis.TimeSpan = 600
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = vbGreen
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn2Min_Released()
    TrendX.XAxis.TimeSpan = 120
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = vbGreen
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn1Min_Released()
    TrendX.XAxis.TimeSpan = 60
    btn30Sec.BackColor = RGB(192, 192, 192)
    btn1Min.BackColor = vbGreen
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub

Private Sub btn30Sec_Released()
    TrendX.XAxis.TimeSpan = 30
    btn30Sec.BackColor = vbGreen
    btn1Min.BackColor = RGB(192, 192, 192)
    btn2Min.BackColor = RGB(192, 192, 192)
    btn10Min.BackColor = RGB(192, 192, 192)
    btn30Min.BackColor = RGB(192, 192, 192)
    btn1h.BackColor = RGB(192, 192, 192)
    btn2h.BackColor = RGB(192, 192, 192)
    btn6h.BackColor = RGB(192, 192, 192)
    btn12h.BackColor = RGB(192, 192, 192)
    btn1j.BackColor = RGB(192, 192, 192)
    btn2j.BackColor = RGB(192, 192, 192)
    btn1s.BackColor = RGB(192, 192, 192)
End Sub




]]>
            </vbaCode>
        </vbaItem>
        <vbaItem>
            <!--Item Name:frm_file, Item Type:Designer-->
            <encryptedData hash="ac09af977d03442980a6ba922fbd9286">
                <!--The following VBA code is encoded.Please do not edit or import will fail.-->
                <![CDATA[J05BTUU9ZnJtX2ZpbGUsVFlQRT0yDQpWRVJTSU9OIDUuMDANCkJlZ2luIHtDNjJBNjlGMC0xNkRD
LTExQ0UtOUU5OC0wMEFBMDA1NzRBNEZ9IGZybV9maWxlIA0KICAgQ2FwdGlvbiAgICAgICAgID0g
ICAiVXNlckZvcm0xIg0KICAgQ2xpZW50SGVpZ2h0ICAgID0gICA1ODUwDQogICBDbGllbnRMZWZ0
ICAgICAgPSAgIDQ1DQogICBDbGllbnRUb3AgICAgICAgPSAgIDMzMA0KICAgQ2xpZW50V2lkdGgg
ICAgID0gICA0NDU1DQogICBPbGVPYmplY3RCbG9iICAgPSAgICJmcm1fZmlsZS5mcngiOjAwMDAN
CiAgIFN0YXJ0VXBQb3NpdGlvbiA9ICAgMSAgJ0NlbnRlck93bmVyDQpFbmQNCkF0dHJpYnV0ZSBW
Ql9OYW1lID0gImZybV9maWxlIg0KQXR0cmlidXRlIFZCX0dsb2JhbE5hbWVTcGFjZSA9IEZhbHNl
DQpBdHRyaWJ1dGUgVkJfQ3JlYXRhYmxlID0gRmFsc2UNCkF0dHJpYnV0ZSBWQl9QcmVkZWNsYXJl
ZElkID0gVHJ1ZQ0KQXR0cmlidXRlIFZCX0V4cG9zZWQgPSBGYWxzZQ0K
]]>
            </encryptedData>
            <vbaCode>
                <![CDATA[
Option Explicit

'Chemin complet dans lequel on est situé actuellement
Dim ActualPath As String
'Options de la fenêtre des fichiers
Public Security As Security_Options

'Création de la fenêtre
Private Sub UserForm_Initialize()
    'Cette commande n'a que pour effet de placer la fenêtre sur le bon écran en cas de double écran.
    Me.Width = 228
End Sub

'Affichage de la fenêtre
Private Sub UserForm_Activate()
    Dim SubDirectory As String

    'Si le nom du fichier est déjà rempli, on vérifie la présence d'un sous répertoire
    If TrendName.Text <> "" Then
        SubDirectory = Mid(TrendName.Text, 1, InStrRev(TrendName.Text, "\", Len(TrendName.Text)))
        'Et on simplifie le nom du fichier
        TrendName.Text = Mid(TrendName.Text, InStrRev(TrendName.Text, "\", Len(TrendName.Text)) + 1)
    Else
        SubDirectory = ""
    End If
    ActualPath = TrendPath & SubDirectory
    
    TrendSubPath = Right(ActualPath, Len(ActualPath) - Len(TrendPath))
    'Mise à jour des répertoires
    RefreshDirectories
    'Mise à jour du titre de la fenêtre
    Me.Caption = "\" & Right(ActualPath, Len(ActualPath) - Len(TrendPath))
    'Mise à jour des courbes existantes
    RefreshTrends

    'Gestion de la sécurité
    Label2.Top = Label1.Top
    TrendList.Top = Label2.Top + 18
    TrendList.Height = 213
    If (Security And (VIEW_FOLDER Or CREATE_FOLDER Or DELETE_FOLDER)) > 0 Then
        DirectoryList.Visible = True
        Label1.Visible = True
        Label2.Top = 132
        TrendList.Top = Label2.Top + 18
        TrendList.Height = 87.75
    End If
    If (Security And CREATE_FOLDER) = CREATE_FOLDER Then
        NewDirectory.Visible = True
        ButtonCreate.Visible = True
    End If
    If (Security And DELETE_FOLDER) = DELETE_FOLDER Then
        ButtonDelete.Visible = True
    End If
End Sub

'Sélection d'un fichier
Private Sub TrendList_Click()
    If frm_file.TrendList.ListIndex <> -1 Then
        TrendName.Text = TrendList.List(frm_file.TrendList.ListIndex)
    End If
End Sub

'Validation de la sélection du fichier
Private Sub TrendList_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    If frm_file.TrendList.ListIndex <> -1 Then
        TrendName.Text = TrendList.List(frm_file.TrendList.ListIndex)
    End If
    ButtonOk_Click
End Sub

'Validation de la sélection du fichier
Private Sub ButtonOk_Click()
    Me.Hide
End Sub

'Annulation de la sélection du fichier
Private Sub ButtonCancel_Click()
    TrendName.Text = ""
    Me.Hide
End Sub

'Gestion des répertoires : Création
Private Sub ButtonCreate_Click()
    On Error GoTo ErrorHandler
    If NewDirectory.Text <> "" Then
        'Création des répertoires sur les deux serveurs
        MkDir "\\" & PRIMARY_SERVER & "\" & PATH_DIRECTORY & TrendSubPath & NewDirectory.Text
        On Error GoTo 0
        NewDirectory.Text = ""
        'Mise à jour des répertoires
        RefreshDirectories
    End If
    Exit Sub
ErrorHandler:
    MsgBox "The folder name is not valid or already exists", vbCritical, "Error to create folder"
End Sub

'Gestion des répertoires : Suppression
Private Sub ButtonDelete_Click()
    On Error GoTo ErrorHandler
    If DirectoryList.ListIndex <> -1 Then
        If DirectoryList.List(DirectoryList.ListIndex) <> ".." Then
            RmDir "\\" & PRIMARY_SERVER & "\" & PATH_DIRECTORY & TrendSubPath & DirectoryList.List(DirectoryList.ListIndex)
            On Error Resume Next
            If SECONDARY_SERVER <> "" Then
                RmDir "\\" & SECONDARY_SERVER & "\" & PATH_DIRECTORY & TrendSubPath & DirectoryList.List(DirectoryList.ListIndex)
            End If
            On Error GoTo 0
            'Mise à jour des répertoires
            RefreshDirectories
        End If
    End If
    Exit Sub
ErrorHandler:
    MsgBox "The specified folder does not exist or is not empty", vbCritical, "Error to delete folder"
End Sub

'Gestion des répertoires : Déplacement
Private Sub DirectoryList_DblClick(ByVal Cancel As MSForms.ReturnBoolean)
    If DirectoryList.ListIndex = -1 Then
        Exit Sub
    End If
    If DirectoryList.List(DirectoryList.ListIndex) = ".." Then
        ActualPath = Mid(ActualPath, 1, InStrRev(ActualPath, "\", Len(ActualPath) - 1))
    Else
        ActualPath = ActualPath & DirectoryList.List(DirectoryList.ListIndex) & "\"
    End If
    TrendSubPath = Right(ActualPath, Len(ActualPath) - Len(TrendPath))
    'Mise à jour des répertoires
    RefreshDirectories
    'Mise à jour du titre de la fenêtre
    Me.Caption = "\" & Right(ActualPath, Len(ActualPath) - Len(TrendPath))
    'Mise à jour des courbes existantes
    RefreshTrends
End Sub

'Gestion des affichages : Mise à jour de la liste des répertoires
Private Sub RefreshDirectories()
    Dim DirectoryName As String

    'Listing des répertoires existants
    DirectoryList.Clear
    DirectoryName = Dir(ActualPath & "*", vbDirectory)
    Do While DirectoryName <> ""
        If DirectoryName <> "." Then
            If (GetAttr(ActualPath & DirectoryName) And vbDirectory) = vbDirectory Then
                If DirectoryName = ".." And ActualPath <> TrendPath Then
                    DirectoryList.AddItem DirectoryName
                ElseIf DirectoryName <> ".." Then
                    DirectoryList.AddItem DirectoryName
                End If
            End If
        End If
        DirectoryName = Dir
    Loop
End Sub

'Gestion des affichages : Mise à jour de la liste des fichiers
Private Sub RefreshTrends()
    Dim TrendName As String

    'Listing des courbes existantes
    TrendList.Clear
    TrendName = Dir(ActualPath & "*" & EXTENSION, vbNormal)
    Do While TrendName <> ""
        TrendList.AddItem Left(TrendName, Len(TrendName) - Len(EXTENSION))
        TrendName = Dir
    Loop
End Sub
]]>
            </vbaCode>
        </vbaItem>
        <vbaItem>
            <!--Item Name:frm_file, Item Type:DesignerBin-->
            <encryptedData hash="d51ef1a61f39c0cf127343995f69056d">
                <!--The following VBA code is encoded.Please do not edit or import will fail.-->
                <![CDATA[J05BTUU9ZnJtX2ZpbGUsVFlQRT0tMQ0KTEIIAAAOAAAAAAAAAAAAAMERAABRGAAA0M8R4KGxGuEA
AAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEA
AAD+////AAAAAAAAAAD/////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////9/////v////7/
//8EAAAABQAAAP7/////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////1IAbwBvAHQAIABF
AG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA
//////////8CAAAA8GkqxtwWzhGemACqAFdKTwAAAAAAAAAAAAAAADAvmgbDt9MBAwAAAAAFAAAA
AAAAZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAQAAgD///////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAOwIAAAAAAABvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACAQEAAAADAAAA/////wAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAoAgAAAAAAAAEAQwBvAG0AcABPAGIAagAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAASAAIA////////////////AAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgAAAG4AAAAAAAAAAQAAAAsAAAADAAAA
BAAAAAUAAAAGAAAABwAAAAgAAAAJAAAACgAAAP7///8MAAAADQAAAA4AAAAPAAAAEAAAABEAAAD+
////EwAAAP7/////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////8ABCgASAwQDA8AAAAE
QAAA//8AABsAAAAAfQAAsh4AAE8oAAAAAAAAAAAAAANS4wuRj84RneMAqgBLuFEBAAAAkAFEQgEA
BlRhaG9tYQAACgAAANQBAAAAigEAAAAoAPUBAAAGAACAAgAAADAAAAA8AAAABwAVAExhYmVsMW0A
1AACHAAoAAAADAAAgEZvbGRlcnMocykgOvAcAAB7AgAAAAIYADUAAAAFAACA8AAAAAACAABBcmlh
bAAAAAACHAAoAAAACQAAgEZpbGUocykgOgBhAPAcAAB7AgAAAAIYADUAAAAFAACA8AAAAAACAABB
cmlhbAAAAAACGAAoAAAABwAAgENvbmZpcm0A7AkAAE8DAAAAAhgAdQAAAAUAAIC0AAAAAAIDAEFy
aWFscm0AAAIYACgAAAAGAACAQ2FuY2VsbQDsCQAATwMAAAACGAB1AAAABQAAgLQAAAAAAgMAQXJp
YWxsbQAAAhgAKAAAAAYAAIBDcmVhdGVtAOwJAABOAwAAAAIYAHUAAAAFAACAtAAAAAACAwBBcmlh
bGVtAAACFAABAQCAAAAAABtIgCwwEgAAewIAAAACGAA1AAAABgAAgKUAAAAAAgAAVGFob21hbQAA
AhgAKAAAAAYAAIBEZWxldGVtAOwJAABPAwAAAAIYAHUAAAAFAACAtAAAAAACAwBBcmlhbGVtAAAC
FAABAQCAAAAAABtIgCzwHAAAewIAAAACGAA1AAAABgAAgKUAAAAAAgAAVGFob21hbQAAAhQAYAEB
gAAAAAADAgAAJR0AABgMAAAAAhgANQAAAAYAAIClAAAAAAIAAFRhaG9tYW0AAAIUAGABAYAAAAAA
AwIAADASAAAqCwAAAAIYADUAAAAGAACApQAAAAACAABUYWhvbWFtAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAANQAAAAAACgA9QEAAAYAAIAEAAAAMgAAADwAAAAIABUATGFiZWwybQDUAAAAMRIA
AAAAKAD1AQAACAAAgAUAAAA3AAAAOAAAAAEAEQBCdXR0b25PS9gTAABhJAAAAAAsAPUBAAAMAACA
BgAAADsAAAA4AAAAAgARAEJ1dHRvbkNhbmNlbNQAAABhJAAAAAAsAPUBAAAMAACABwAAADkAAAA4
AAAABAARAEJ1dHRvbkNyZWF0ZdgTAABPAwAAAAAsAPUBAAAMAACACAAAADEAAAA0AAAAAwAXAE5l
d0RpcmVjdG9yedQAAABPAwAAAAAsAPUBAAAMAACACQAAADkAAAA4AAAABgARAEJ1dHRvbkRlbGV0
ZdgTAACdBgAAAAAoAOUBAAAJAACACgAAADQAAAAJABcAVHJlbmROYW1lZXRl1AAAABMhAAAAACgA
5QEAAAkAAIADAAAANAAAAAAAGABUcmVuZExpc3RldGXUAAAArBQAAAAAMAD1AQAADQAAgAEAAAAx
AAAANAAAAAUAGABEaXJlY3RvcnlMaXN0AAAA1AAAAJ0GAAAAAgwAGQAAAPN/AQD/AQAAAAAAAAAB
AP7/AwoAAP/////waSrG3BbOEZ6YAKoAV0pPGQAAAE1pY3Jvc29mdCBGb3JtcyAyLjAgRm9ybQAQ
AAAARW1iZWRkZWQgT2JqZWN0AA0AAABGb3Jtcy5Gb3JtLjEA9DmycQAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
]]>
            </encryptedData>
        </vbaItem>
        <vbaItem>
            <!--Item Name:frm_timespan, Item Type:Designer-->
            <encryptedData hash="f64927609e54d58314797006d88ac707">
                <!--The following VBA code is encoded.Please do not edit or import will fail.-->
                <![CDATA[J05BTUU9ZnJtX3RpbWVzcGFuLFRZUEU9Mg0KVkVSU0lPTiA1LjAwDQpCZWdpbiB7QzYyQTY5RjAt
MTZEQy0xMUNFLTlFOTgtMDBBQTAwNTc0QTRGfSBmcm1fdGltZXNwYW4gDQogICBDYXB0aW9uICAg
ICAgICAgPSAgICJTZXQgdGltZSAmIGRhdGUiDQogICBDbGllbnRIZWlnaHQgICAgPSAgIDUzMjUN
CiAgIENsaWVudExlZnQgICAgICA9ICAgNDUNCiAgIENsaWVudFRvcCAgICAgICA9ICAgMzMwDQog
ICBDbGllbnRXaWR0aCAgICAgPSAgIDQzMjANCiAgIE9sZU9iamVjdEJsb2IgICA9ICAgImZybV90
aW1lc3Bhbi5mcngiOjAwMDANCiAgIFN0YXJ0VXBQb3NpdGlvbiA9ICAgMSAgJ0NlbnRlck93bmVy
DQpFbmQNCkF0dHJpYnV0ZSBWQl9OYW1lID0gImZybV90aW1lc3BhbiINCkF0dHJpYnV0ZSBWQl9H
bG9iYWxOYW1lU3BhY2UgPSBGYWxzZQ0KQXR0cmlidXRlIFZCX0NyZWF0YWJsZSA9IEZhbHNlDQpB
dHRyaWJ1dGUgVkJfUHJlZGVjbGFyZWRJZCA9IFRydWUNCkF0dHJpYnV0ZSBWQl9FeHBvc2VkID0g
RmFsc2UNCg==]]>
            </encryptedData>
            <vbaCode>
                <![CDATA[
Option Explicit



'Création de la feuille
Private Sub UserForm_Initialize()
    Dim i As Long

    Me.Width = 220

    'Le sélectionneur de date de départ
    opt_nostartdate.Value = True
    'Les listes
    cb_jour_start.Clear
    For i = 1 To 31
        If i < 10 Then
            cb_jour_start.AddItem "0" & CStr(i)
        Else
            cb_jour_start.AddItem i
        End If
    Next i
    cb_mois_start.Clear
    cb_mois_start.AddItem "January"
    cb_mois_start.AddItem "February"
    cb_mois_start.AddItem "March"
    cb_mois_start.AddItem "April"
    cb_mois_start.AddItem "May"
    cb_mois_start.AddItem "June"
    cb_mois_start.AddItem "July"
    cb_mois_start.AddItem "August"
    cb_mois_start.AddItem "September"
    cb_mois_start.AddItem "October"
    cb_mois_start.AddItem "November"
    cb_mois_start.AddItem "December"
    cb_annee_start.Clear
    For i = 1990 To Year(Date) + 1
        cb_annee_start.AddItem i
    Next i

    'Le sélectionneur de date de fin
    opt_noenddate.Value = True
    'Les listes
    cb_jour_end.Clear
    For i = 1 To 31
        If i < 10 Then
            cb_jour_end.AddItem "0" & CStr(i)
        Else
            cb_jour_end.AddItem i
        End If
    Next i
    cb_mois_end.Clear
    cb_mois_end.AddItem "January"
    cb_mois_end.AddItem "February"
    cb_mois_end.AddItem "March"
    cb_mois_end.AddItem "April"
    cb_mois_end.AddItem "May"
    cb_mois_end.AddItem "June"
    cb_mois_end.AddItem "July"
    cb_mois_end.AddItem "August"
    cb_mois_end.AddItem "September"
    cb_mois_end.AddItem "October"
    cb_mois_end.AddItem "November"
    cb_mois_end.AddItem "Décember"
    cb_annee_end.Clear
    For i = 1990 To Year(Date) + 1
        cb_annee_end.AddItem i
    Next i

    'Les listes
    cb_timespan_type.Clear
    cb_timespan_type.AddItem "Second(s)"
    cb_timespan_type.AddItem "Minute(s)"
    cb_timespan_type.AddItem "Hour(s)"
    cb_timespan_type.AddItem "Day(s)"
End Sub

'Affichage de la feuille
Private Sub UserForm_Activate()
    Dim myStartDate As Date
    Dim myEndDate As Date

    myStartDate = CDate(StartTime.Text)
    myEndDate = DateAdd("s", tb_timespan_value, myStartDate)
    'Attribution des valeurs
    cb_jour_start.ListIndex = Day(myStartDate) - 1
    cb_mois_start.ListIndex = Month(myStartDate) - 1
    cb_annee_start.ListIndex = Year(myStartDate) - 1990
    tb_heure_start.Text = Hour(myStartDate)
    tb_minute_start = Minute(myStartDate)
    tb_seconde_start = Second(myStartDate)
    'Attribution des valeurs
    cb_jour_end.ListIndex = Day(myEndDate) - 1
    cb_mois_end.ListIndex = Month(myEndDate) - 1
    cb_annee_end.ListIndex = Year(myEndDate) - 1990
    tb_heure_end.Text = Hour(myEndDate)
    tb_minute_end = Minute(myEndDate)
    tb_seconde_end = Second(myEndDate)
    'On règle le TimeSpan
    If CInt(tb_timespan_value.Text / 86400) = (tb_timespan_value.Text / 86400) Then
        tb_timespan_value.Text = tb_timespan_value.Text / 86400
        cb_timespan_type.ListIndex = 3
    ElseIf CInt(tb_timespan_value.Text / 3600) = (tb_timespan_value.Text / 3600) Then
        tb_timespan_value.Text = tb_timespan_value.Text / 3600
        cb_timespan_type.ListIndex = 2
    ElseIf CInt(tb_timespan_value.Text / 60) = (tb_timespan_value.Text / 60) Then
        tb_timespan_value.Text = tb_timespan_value.Text / 60
        cb_timespan_type.ListIndex = 1
    Else
        cb_timespan_type.ListIndex = 0
    End If
End Sub

'Appui sur lq croix
Private Sub UserForm_QueryClose(Cancel As Integer, CloseMode As Integer)
    Cancel = True
    Me.Hide
End Sub

'Appui sur le bouton Annuler
Private Sub ButtonCancel_Click()
    Me.Hide
End Sub

'Appui sur le bouton Ouvrir
Private Sub ButtonOk_Click()
    Me.Hide
End Sub

'Appui sur le choix "Pas de date de depart"
Private Sub opt_nostartdate_Click()
    frm_startdate.Enabled = False
    opt_enddate.Enabled = False
    opt_noenddate.Value = True
End Sub

'Appui sur le choix "Date de depart"
Private Sub opt_startdate_Click()
    frm_startdate.Enabled = True
    opt_enddate.Enabled = True
End Sub

'Appui sur le choix "Pas de date de fin"
Private Sub opt_noenddate_Click()
    frm_enddate.Visible = False
    frm_timespan.Visible = True
End Sub

'Appui sur le choix "Date de fin"
Private Sub opt_enddate_Click()
    frm_enddate.Visible = True
    frm_timespan.Visible = False
End Sub

Private Sub sb_heure_start_SpinDown()
    If tb_heure_start.Text = 0 Then
        tb_heure_start.Text = "24"
    End If
    If (tb_heure_start.Text - 1) < 10 Then
        tb_heure_start.Text = "0" & CStr(tb_heure_start.Text - 1)
    Else
        tb_heure_start.Text = CStr(tb_heure_start.Text - 1)
    End If
End Sub

Private Sub sb_heure_start_SpinUp()
    If (tb_heure_start.Text + 1) < 10 Then
        tb_heure_start.Text = "0" & CStr(tb_heure_start.Text + 1)
    Else
        tb_heure_start.Text = CStr(tb_heure_start.Text + 1)
    End If
    If tb_heure_start.Text > 23 Then
        tb_heure_start.Text = "00"
    End If
End Sub

Private Sub sb_minute_start_SpinDown()
    If tb_minute_start.Text = 0 Then
        tb_minute_start.Text = "60"
    End If
    If (tb_minute_start.Text - 1) < 10 Then
        tb_minute_start.Text = "0" & CStr(tb_minute_start.Text - 1)
    Else
        tb_minute_start.Text = CStr(tb_minute_start.Text - 1)
    End If
End Sub

Private Sub sb_minute_start_SpinUp()
    If (tb_minute_start.Text + 1) < 10 Then
        tb_minute_start.Text = "0" & CStr(tb_minute_start.Text + 1)
    Else
        tb_minute_start.Text = CStr(tb_minute_start.Text + 1)
    End If
    If tb_minute_start.Text > 59 Then
        tb_minute_start.Text = "00"
    End If
End Sub

Private Sub sb_seconde_start_SpinDown()
    If tb_seconde_start.Text = 0 Then
        tb_seconde_start.Text = "60"
    End If
    If (tb_seconde_start.Text - 1) < 10 Then
        tb_seconde_start.Text = "0" & CStr(tb_seconde_start.Text - 1)
    Else
        tb_seconde_start.Text = CStr(tb_seconde_start.Text - 1)
    End If
End Sub

Private Sub sb_seconde_start_SpinUp()
    If (tb_seconde_start.Text + 1) < 10 Then
        tb_seconde_start.Text = "0" & CStr(tb_seconde_start.Text + 1)
    Else
        tb_seconde_start.Text = CStr(tb_seconde_start.Text + 1)
    End If
    If tb_seconde_start.Text > 59 Then
        tb_seconde_start.Text = "00"
    End If
End Sub

Private Sub sb_heure_end_SpinDown()
    If tb_heure_end.Text = 0 Then
        tb_heure_end.Text = "24"
    End If
    If (tb_heure_end.Text - 1) < 10 Then
        tb_heure_end.Text = "0" & CStr(tb_heure_end.Text - 1)
    Else
        tb_heure_end.Text = CStr(tb_heure_end.Text - 1)
    End If
End Sub

Private Sub sb_heure_end_SpinUp()
    If (tb_heure_end.Text + 1) < 10 Then
        tb_heure_end.Text = "0" & CStr(tb_heure_end.Text + 1)
    Else
        tb_heure_end.Text = CStr(tb_heure_end.Text + 1)
    End If
    If tb_heure_end.Text > 23 Then
        tb_heure_end.Text = "00"
    End If
End Sub

Private Sub sb_minute_end_SpinDown()
    If tb_minute_end.Text = 0 Then
        tb_minute_end.Text = "60"
    End If
    If (tb_minute_end.Text - 1) < 10 Then
        tb_minute_end.Text = "0" & CStr(tb_minute_end.Text - 1)
    Else
        tb_minute_end.Text = CStr(tb_minute_end.Text - 1)
    End If
End Sub

Private Sub sb_minute_end_SpinUp()
    If (tb_minute_end.Text + 1) < 10 Then
        tb_minute_end.Text = "0" & CStr(tb_minute_end.Text + 1)
    Else
        tb_minute_end.Text = CStr(tb_minute_end.Text + 1)
    End If
    If tb_minute_end.Text > 59 Then
        tb_minute_end.Text = "00"
    End If
End Sub

Private Sub sb_seconde_end_SpinDown()
    If tb_seconde_end.Text = 0 Then
        tb_seconde_end.Text = "60"
    End If
    If (tb_seconde_end.Text - 1) < 10 Then
        tb_seconde_end.Text = "0" & CStr(tb_seconde_end.Text - 1)
    Else
        tb_seconde_end.Text = CStr(tb_seconde_end.Text - 1)
    End If
End Sub

Private Sub sb_seconde_end_SpinUp()
    If (tb_seconde_end.Text + 1) < 10 Then
        tb_seconde_end.Text = "0" & CStr(tb_seconde_end.Text + 1)
    Else
        tb_seconde_end.Text = CStr(tb_seconde_end.Text + 1)
    End If
    If tb_seconde_end.Text > 59 Then
        tb_seconde_end.Text = "00"
    End If
End Sub
]]>
            </vbaCode>
        </vbaItem>
        <vbaItem>
            <!--Item Name:frm_timespan, Item Type:DesignerBin-->
            <encryptedData hash="b03634429af37ecdc18f8613ff6ef1b4">
                <!--The following VBA code is encoded.Please do not edit or import will fail.-->
                <![CDATA[J05BTUU9ZnJtX3RpbWVzcGFuLFRZUEU9LTENCkxCCAAAKAAAAAAAAAAAAAA6EQAARBYAANDPEeCh
sRrhAAAAAAAAAAAAAAAAAAAAAD4AAwD+/wkABgAAAAAAAAAAAAAAAQAAAAQAAAAAAAAAABAAAAgA
AAABAAAA/v///wAAAAAFAAAA////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////AAAAOwAA
ADgAAAACABEAQnV0dG9uQ2FuY2Vs1AAAABMhAAAAACwA9QEAAAkAAIA0AAAAMQAAADQAAAADABcA
U3RhcnRUaW1lY2VswAoAABMhAAAAAgwAGQAAAPN/AQD/AQAA////////////////////////////
//////////8BAP7/AwoAAP/////waSrG3BbOEZ6YAKoAV0pPGQAAAE1pY3Jvc29mdCBGb3JtcyAy
LjAgRm9ybQAQAAAARW1iZWRkZWQgT2JqZWN0AA0AAABGb3Jtcy5Gb3JtLjEA9DmycQAAAAAAAAAA
AAAAAP//////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////9SAG8AbwB0
ACAARQBuAHQAcgB5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
FgAFAP//////////AgAAAPBpKsbcFs4RnpgAqgBXSk8AAAAAAAAAAAAAAAAAAAAAAAAAAAMAAACA
AAAAAAAAAGYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAEAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAE8AAAAAAAAAbwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAgEBAAAAAwAAAP////8AAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD+////AAAAAAAAAABpADAAMwAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABAP//////////////
/wAAAAAAAAAAAAAAAAAAAAAAAAAA8AOcBsO30wHwA5wGw7fTAQAAAAAAAAAAAAAAAAEAAAD+////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////AAQoAEgMEAw0
AAAABEAAAP//AABzAAAAAH0AAMQdAACxJAAAAAAAAAAAAAADUuMLkY/OEZ3jAKoAS7hRAQAAAJAB
REIBAAZUYWhvbWEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABSAG8AbwB0ACAA
RQBuAHQAcgB5AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFgAF
AP//////////AgAAAPBpKsbcFs4RnpgAqgBXSk8AAAAAAAAAAAAAAAAAK5wGw7fTAQkAAAAAEQAA
AAAAAGYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAEAAIB////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAACMBAAAAAAAAbwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAgEBAAAAAwAAAP////8AAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAA8AAAAoAAAAAAAAABpADAAMwAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABAf////8TAAAABQAAACAg
GG5g9M4Rm80AqgBgjgEAAAAA8AOcBsO30wEAK5wGw7fTAQAAAAAAAAAAAAAAAP7/////////////
//////8GAAAA/f///wcAAAAKAAAA/v///wwAAAALAAAA/v///w0AAAAOAAAADwAAABAAAAARAAAA
EgAAAAAAAAD/////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////ZgAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAgH/
//////////////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAALAAAA0QEAAAAA
AABvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAABAACAQQAAAAHAAAA/////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAQAAACwAQAAAAAAAGkAMQAzAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAEB//////////8RAAAAICAYbmD0zhGbzQCqAGCOAQAA
AADwA5wGw7fTAfADnAbDt9MBAAAAAAAAAAAAAAAAaQAyADQAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAQAGAAAACAAAAA4AAAAgIBhu
YPTOEZvNAKoAYI4BAAAAAPADnAbDt9MB8AOcBsO30wEAAAAAAAAAAAAAAABpADIAOQAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAABAf//
//8JAAAACwAAACAgGG5g9M4Rm80AqgBgjgEAAAAA8AOcBsO30wEAK5wGw7fTAQAAAAAAAAAAAAAA
AAEAQwBvAG0AcABPAGIAagAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAASAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAgAAAHAAAAAAAAAAZgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAQAAgD///////////////8AAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAXAAAAxAAAAAAAAABvAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACAQoAAAAMAAAA/////wAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABUAAABwAAAAAAAAAAEAAAA/AAAAAwAAAP7/
//8FAAAABgAAAAcAAAAIAAAACQAAAAoAAAD+////DAAAAA0AAAAOAAAADwAAABAAAAARAAAAEgAA
AP7///8UAAAA/v///xYAAAD+////GAAAABkAAAAaAAAA/v///xwAAAD+////HgAAAB8AAAAgAAAA
IQAAACIAAAD+////JAAAACUAAAAmAAAAJwAAACgAAAApAAAAKgAAAP7///8sAAAA/v///y4AAAAv
AAAAMAAAADEAAAAyAAAA/v///zQAAAA1AAAANgAAADcAAAA4AAAAOQAAADoAAAA7AAAA/v///z0A
AAA+AAAA/v///0AAAABBAAAA/v///0MAAAD+////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////AAQoAEgMEAw0AAAABEAA
AP//AABzAAAAAH0AAMQdAACxJAAAAAAAAAAAAAADUuMLkY/OEZ3jAKoAS7hRAQAAAJABREIBAAZU
YWhvbWEAAAQAAAC8AAAAAIQBbwAAKADVAQAACgAAgAMAAAAjAAQAAAAOAGZybV9kZXBhcnRlLtQB
AP7/AwoAAP////8gIBhuYPTOEZvNAKoAYI4BGgAAAE1pY3Jvc29mdCBGb3JtcyAyLjAgRnJhbWUA
EAAAAEVtYmVkZGVkIE9iamVjdAAOAAAARm9ybXMuRnJhbWUuMQD0ObJxAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAACWABGAcCAAQAAAA8AAIASAACABQAAAAEAAIAeAACACQAAgNcZAAD3AQAA
MAAAAFVzZSBjdXJyZW50IGRhdGUgYXMgU3RhcnQgRGF0ZWUAc3RhcnRkYXRlbnQgAAIYADUAAAAG
AACApQAAAAACAABUYWhvbWEAAAACUABGAcCAAQAAAA8AAIASAACABQAAAAEAAIAWAACACQAAgOoS
AAD3AQAAMAAAAFVzZSBhbm90aGVyIFN0YXJ0IERhdGUAAHN0YXJ0ZGF0ZWVyIAACGAA1AAAABgAA
gKUAAAAAAgAAVGFob21hAAAAAkQARgHAgAEAAAAPAACAEgAAgAUAAAABAEMAbwBtAHAATwBiAGoA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgACAP//////
/////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABMAAABwAAAAAAAAAGYA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAEAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
IwAAAPgBAAAAAAAAbwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAQAAgENAAAADwAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAdAAAAgAEAAAAAAAABAEMAbwBtAHAATwBiAGoAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEgACAP///////////////wAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABsAAABwAAAAAAAAAGYAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIA////////
////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMwAAABACAAAAAAAAbwAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
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
]]>
            </encryptedData>
        </vbaItem>
        <vbaItem>
            <!--Item Name:ModData, Item Type:CodeModule-->
            <encryptedData hash="d67438ff5e849ce44a697b61cc082d39">
                <!--The following VBA code is encoded.Please do not edit or import will fail.-->
                <![CDATA[J05BTUU9TW9kRGF0YSxUWVBFPTANCkF0dHJpYnV0ZSBWQl9OYW1lID0gIk1vZERhdGEiDQo=]]>
            </encryptedData>
            <vbaCode>
                <![CDATA[' Ce module sert simplement à partager des variables entre la feuille principale
' et les sous-feuilles
Option Explicit

Public Enum Security_Options
    NO_RIGHT = &H0
    VIEW_FOLDER = &H1
    CREATE_FOLDER = &H2
    DELETE_FOLDER = &H4
    ALL_RIGHTS = &HFF
End Enum

Public Const PATH_DIRECTORY As String = "Users\Public\Documents\RSView Enterprise\SE\HMI projects\TOPSIDE\TREND\"
Public Const PRIMARY_SERVER As String = "TSCSSVRA"
Public Const SECONDARY_SERVER As String = "TSCSSVRB"
Public Const EXTENSION As String = ".tlst"

'Sécurité globale sur tous les boutons de la vue
Public Const Security_Global As Long = ALL_RIGHTS
'Sécurité spécifique pour le bouton de chargement
Public Const Security_Load As Long = Security_Global
'Sécurité spécifique pour le bouton de sauvegarde
Public Const Security_Save As Long = Security_Global
'Sécurité spécifique pour le bouton de suppression
Public Const Security_Delete As Long = Security_Global

Public HMIServer As String
Public TrendPath As String
Public TrendSubPath As String


' Droits à gérer sur les boutons
' Boutons de plage de temps à rajouter sous le Trend
' Créer un Browser de Tags

' ======== FAIT ========
' Utilisation d'un seul serveur HMI : SECONDARY => chaine vide
' Virer le "Courbe chargée"
' Supprimer les répertoires sur chaque serveur
' Interdire la sauvegarde si pas de pen
' Prendre en compte l'erreur de suppression du répertoire si celui-ci n'est pas vide
' Remplacer le texte des boutons par un zoli dessin ?
' Quand on sauve, il faudrait retourner dans le bon répertoire directement
' Quand on charge/delete aussi ?

'SYLVAIN --> THOMAS (25/11/2011)
'Gérer erreur VB si Le répertoire n'existe pas  => FAIT
'Gérer erreur VB si un des serveurs n'est pas présent   => FAIT
'Gestion de la sécurité (Supprimer dossier, fichier,créer ...)  => FAIT
]]>
            </vbaCode>
        </vbaItem>
    </vbaProject>
</gfx>
